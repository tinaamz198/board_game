package com.example.boardgame;

import android.content.Context;
import androidx.annotation.NonNull;
import androidx.room.Database;
import androidx.room.Room;
import androidx.room.RoomDatabase;
import androidx.sqlite.db.SupportSQLiteDatabase;
import java.util.concurrent.Executors;

@Database(entities = {BoardGame.class}, version = 1)
public abstract class AppDatabase extends RoomDatabase {
    private static AppDatabase instance;
    public abstract GameDao gameDao();

    public static synchronized AppDatabase getInstance(Context context) {
        if (instance == null) {
            instance = Room.databaseBuilder(context.getApplicationContext(),
                            AppDatabase.class, "game_database")
                    .fallbackToDestructiveMigration()
                    .addCallback(roomCallback)
                    .build();
        }
        return instance;
    }

    private static final RoomDatabase.Callback roomCallback = new RoomDatabase.Callback() {
        @Override
        public void onCreate(@NonNull SupportSQLiteDatabase db) {
            super.onCreate(db);
            Executors.newSingleThreadExecutor().execute(() -> {
                GameDao dao = instance.gameDao();

                // 1. Правда или Действие
                dao.insert(new BoardGame("Правда или Действие",
                        "Популярная игра для вечеринок, помогающая узнать друг друга лучше в игровой форме.",
                        "Игроки по очереди выбирают 'Правда' (честный ответ на вопрос) или 'Действие' (выполнение задания). Если игрок отказывается, он должен выполнить штрафное задание от компании.",
                        "game2", true, false, false, "2-10", "Легко", "Вечеринка", 4.5f));

                // 2. Мафия
                dao.insert(new BoardGame("Мафия",
                        "Психологическая пошаговая ролевая игра с детективным сюжетом, моделирующая борьбу информированных членов преступного сообщества с неорганизованным большинством.",
                        "Игроки делятся на 'Мирных жителей' и 'Мафию'. Ночью мафия убивает, днем жители пытаются вычислить мафию путем обсуждения и голосования.",
                        "game1", true, false, false, "6-15", "Средне", "Детектив", 4.8f));

                // 3. Монополия
                dao.insert(new BoardGame("Монополия",
                        "Классическая экономическая стратегия, где ваша цель — рационально используя стартовый капитал, добиться банкротства других игроков.",
                        "Бросайте кубики и передвигайте фишку по полю. Покупайте свободную недвижимость, берите аренду с соперников, стройте филиалы и отели.",
                        "monopoly", false, false, false, "2-6", "Сложно", "Стратегия", 4.2f));

                // 4. Имаджинариум
                dao.insert(new BoardGame("Имаджинариум",
                        "Увлекательная игра на ассоциации, которая позволит вам лучше узнать полет фантазии ваших друзей.",
                        "Ведущий загадывает ассоциацию на одну из своих карт и кладет её на стол рубашкой вверх. Остальные выбирают наиболее подходящую под описание карту из своих. Задача — угадать карту ведущего.",
                        "imaginary", false, false, false, "3-7", "Легко", "Творчество", 5.0f));

                // 5. Кодовые Имена
                dao.insert(new BoardGame("Кодовые Имена",
                        "Командная игра, в которой капитаны пытаются связать несколько слов на поле одной подсказкой.",
                        "Капитаны дают подсказку, состоящую из одного слова и числа. Команда должна найти слова своего цвета на поле, стараясь не выбрать карту соперника или 'убийцу'.",
                        "game3", true, false, false, "2-8", "Средне", "Интеллектуальная", 4.7f));

                // 6. Элиас Элиас (Alias)
                dao.insert(new BoardGame("Элиас",
                        "Динамичная игра на разъяснение слов, где нужно проявить красноречие и быстроту реакции.",
                        "Объясняйте слова на карточках своим сокомандникам, используя синонимы, антонимы и подсказки, но не называя само слово и однокоренные слова.",
                        "aliase", true, false, false, "4-12", "Легко", "Вечеринка", 4.6f));

                // 7. Гномы-вредители (Saboteur)
                dao.insert(new BoardGame("Гномы-вредители",
                        "Игра с тайными ролями, где честные гномы строят туннель к золоту, а вредители пытаются им помешать.",
                        "Игроки прокладывают путь картами туннелей. Вредители тайно ломают инструменты и строят тупики. В конце раунда золото делится между победителями.",
                        "saboteur", false, false, false, "3-10", "Средне", "Для компании", 4.4f));

                // 8. Свинтус
                dao.insert(new BoardGame("Свинтус",
                        "Быстрая и веселая карточная игра, цель которой — избавиться от всех своих карт быстрее соперников.",
                        "Выкладывайте карты в стопку по цвету или номиналу. Используйте специальные свинячьи карты, чтобы заставить других брать лишние карты или молчать.",
                        "svintus", false, false, false, "2-10", "Легко", "Карточная", 4.3f));

                // 9. Эволюция
                dao.insert(new BoardGame("Эволюция",
                        "Научно-популярная стратегия, где вы создаете собственных существ и помогаете им выжить в условиях нехватки еды.",
                        "Добавляйте животным свойства (хищник, камуфляж, полет), чтобы они могли охотиться и защищаться. Каждый ход количество еды меняется — выживают самые приспособленные.",
                        "evolution", false, false, false, "2-4", "Сложно", "Стратегия", 4.5f));

                dao.insert(new BoardGame("Цитадели",
                        "Стратегия о строительстве средневековых городов и борьбе за влияние при дворе.",
                        "Каждый раунд игроки тайно выбирают персонажей с уникальными способностями (Ассасин, Вор, Зодчий). Стройте кварталы, копите золото и мешайте планам оппонентов.",
                        "fantasy", false, false, false, "2-8", "Сложно", "Стратегия", 4.8f));

            });
        }
    };
}
